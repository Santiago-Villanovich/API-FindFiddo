USE [master]
GO
/****** Object:  Database [FindFiddo_App]    Script Date: 10/11/2024 19:52:19 ******/
CREATE DATABASE [FindFiddo_App]
 CONTAINMENT = NONE
 ON  PRIMARY 
( NAME = N'FindFiddo_App', FILENAME = N'C:\Program Files\Microsoft SQL Server\MSSQL16.MSSQLSERVER\MSSQL\DATA\FindFiddo_App.mdf' , SIZE = 8192KB , MAXSIZE = UNLIMITED, FILEGROWTH = 65536KB )
 LOG ON 
( NAME = N'FindFiddo_App_log', FILENAME = N'C:\Program Files\Microsoft SQL Server\MSSQL16.MSSQLSERVER\MSSQL\DATA\FindFiddo_App_log.ldf' , SIZE = 73728KB , MAXSIZE = 2048GB , FILEGROWTH = 65536KB )
 WITH CATALOG_COLLATION = DATABASE_DEFAULT, LEDGER = OFF
GO
ALTER DATABASE [FindFiddo_App] SET COMPATIBILITY_LEVEL = 160
GO
IF (1 = FULLTEXTSERVICEPROPERTY('IsFullTextInstalled'))
begin
EXEC [FindFiddo_App].[dbo].[sp_fulltext_database] @action = 'enable'
end
GO
ALTER DATABASE [FindFiddo_App] SET ANSI_NULL_DEFAULT OFF 
GO
ALTER DATABASE [FindFiddo_App] SET ANSI_NULLS OFF 
GO
ALTER DATABASE [FindFiddo_App] SET ANSI_PADDING OFF 
GO
ALTER DATABASE [FindFiddo_App] SET ANSI_WARNINGS OFF 
GO
ALTER DATABASE [FindFiddo_App] SET ARITHABORT OFF 
GO
ALTER DATABASE [FindFiddo_App] SET AUTO_CLOSE OFF 
GO
ALTER DATABASE [FindFiddo_App] SET AUTO_SHRINK OFF 
GO
ALTER DATABASE [FindFiddo_App] SET AUTO_UPDATE_STATISTICS ON 
GO
ALTER DATABASE [FindFiddo_App] SET CURSOR_CLOSE_ON_COMMIT OFF 
GO
ALTER DATABASE [FindFiddo_App] SET CURSOR_DEFAULT  GLOBAL 
GO
ALTER DATABASE [FindFiddo_App] SET CONCAT_NULL_YIELDS_NULL OFF 
GO
ALTER DATABASE [FindFiddo_App] SET NUMERIC_ROUNDABORT OFF 
GO
ALTER DATABASE [FindFiddo_App] SET QUOTED_IDENTIFIER OFF 
GO
ALTER DATABASE [FindFiddo_App] SET RECURSIVE_TRIGGERS OFF 
GO
ALTER DATABASE [FindFiddo_App] SET  DISABLE_BROKER 
GO
ALTER DATABASE [FindFiddo_App] SET AUTO_UPDATE_STATISTICS_ASYNC OFF 
GO
ALTER DATABASE [FindFiddo_App] SET DATE_CORRELATION_OPTIMIZATION OFF 
GO
ALTER DATABASE [FindFiddo_App] SET TRUSTWORTHY OFF 
GO
ALTER DATABASE [FindFiddo_App] SET ALLOW_SNAPSHOT_ISOLATION OFF 
GO
ALTER DATABASE [FindFiddo_App] SET PARAMETERIZATION SIMPLE 
GO
ALTER DATABASE [FindFiddo_App] SET READ_COMMITTED_SNAPSHOT OFF 
GO
ALTER DATABASE [FindFiddo_App] SET HONOR_BROKER_PRIORITY OFF 
GO
ALTER DATABASE [FindFiddo_App] SET RECOVERY FULL 
GO
ALTER DATABASE [FindFiddo_App] SET  MULTI_USER 
GO
ALTER DATABASE [FindFiddo_App] SET PAGE_VERIFY CHECKSUM  
GO
ALTER DATABASE [FindFiddo_App] SET DB_CHAINING OFF 
GO
ALTER DATABASE [FindFiddo_App] SET FILESTREAM( NON_TRANSACTED_ACCESS = OFF ) 
GO
ALTER DATABASE [FindFiddo_App] SET TARGET_RECOVERY_TIME = 60 SECONDS 
GO
ALTER DATABASE [FindFiddo_App] SET DELAYED_DURABILITY = DISABLED 
GO
ALTER DATABASE [FindFiddo_App] SET ACCELERATED_DATABASE_RECOVERY = OFF  
GO
EXEC sys.sp_db_vardecimal_storage_format N'FindFiddo_App', N'ON'
GO
ALTER DATABASE [FindFiddo_App] SET QUERY_STORE = ON
GO
ALTER DATABASE [FindFiddo_App] SET QUERY_STORE (OPERATION_MODE = READ_WRITE, CLEANUP_POLICY = (STALE_QUERY_THRESHOLD_DAYS = 30), DATA_FLUSH_INTERVAL_SECONDS = 900, INTERVAL_LENGTH_MINUTES = 60, MAX_STORAGE_SIZE_MB = 1000, QUERY_CAPTURE_MODE = AUTO, SIZE_BASED_CLEANUP_MODE = AUTO, MAX_PLANS_PER_QUERY = 200, WAIT_STATS_CAPTURE_MODE = ON)
GO
USE [FindFiddo_App]
GO
/****** Object:  UserDefinedFunction [dbo].[DesencriptarDato]    Script Date: 10/11/2024 19:52:19 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- Función para desencriptar datos
CREATE FUNCTION [dbo].[DesencriptarDato](@dato VARBINARY(8000))
RETURNS NVARCHAR(MAX)
AS
BEGIN
    RETURN DECRYPTBYPASSPHRASE('Fiddo12345', @dato);
END;
GO
/****** Object:  UserDefinedFunction [dbo].[EncriptarDato]    Script Date: 10/11/2024 19:52:19 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- Función para encriptar datos
CREATE FUNCTION [dbo].[EncriptarDato](@dato NVARCHAR(MAX))
RETURNS VARBINARY(8000)
AS
BEGIN
    RETURN ENCRYPTBYPASSPHRASE('Fiddo12345', @dato);
END;
GO
/****** Object:  Table [dbo].[archivos]    Script Date: 10/11/2024 19:52:19 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[archivos](
	[id_archivo] [uniqueidentifier] NOT NULL,
	[is_publicacion] [bit] NULL,
	[id_publicacion] [uniqueidentifier] NULL,
	[id_usuario] [uniqueidentifier] NULL,
	[tipo] [nvarchar](max) NULL,
	[imagen] [varbinary](1) NULL,
PRIMARY KEY CLUSTERED 
(
	[id_archivo] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  Table [dbo].[categorias]    Script Date: 10/11/2024 19:52:19 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[categorias](
	[id_categoria] [uniqueidentifier] NOT NULL,
	[nombre] [nvarchar](max) NULL,
	[deleted] [bit] NULL,
PRIMARY KEY CLUSTERED 
(
	[id_categoria] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  Table [dbo].[idiomas]    Script Date: 10/11/2024 19:52:19 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[idiomas](
	[id_idioma] [uniqueidentifier] NOT NULL,
	[descripcion] [nvarchar](max) NULL,
PRIMARY KEY CLUSTERED 
(
	[id_idioma] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  Table [dbo].[log_usuario]    Script Date: 10/11/2024 19:52:19 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[log_usuario](
	[id_log] [uniqueidentifier] NOT NULL,
	[id_usuario] [varbinary](max) NOT NULL,
	[accion] [varbinary](max) NULL,
	[fecha] [varbinary](max) NOT NULL
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  Table [dbo].[log_usuario_publicaciones]    Script Date: 10/11/2024 19:52:19 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[log_usuario_publicaciones](
	[id_log] [uniqueidentifier] NOT NULL,
	[id_usuario] [uniqueidentifier] NULL,
	[id_publicacion] [uniqueidentifier] NULL,
	[is_like] [bit] NULL,
	[is_match] [bit] NULL,
	[fecha] [datetime] NULL,
PRIMARY KEY CLUSTERED 
(
	[id_log] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[match]    Script Date: 10/11/2024 19:52:19 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[match](
	[id_match] [uniqueidentifier] NOT NULL,
	[id_publicacion] [uniqueidentifier] NULL,
	[id_usuario] [uniqueidentifier] NULL,
	[estado] [nvarchar](1) NULL,
	[timestamp] [datetime] NULL,
PRIMARY KEY CLUSTERED 
(
	[id_match] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[mirror_usuario]    Script Date: 10/11/2024 19:52:19 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[mirror_usuario](
	[id_usuario] [uniqueidentifier] NOT NULL,
	[nombres] [nvarchar](max) NULL,
	[apellidos] [nvarchar](max) NULL,
	[dni] [nvarchar](max) NULL,
	[email] [nvarchar](max) NULL,
	[telefono] [nvarchar](max) NULL,
	[clave] [nvarchar](max) NULL,
	[fecha_nacimiento] [datetime] NULL,
	[direccion] [nvarchar](max) NULL,
	[codigo_postal] [int] NULL,
	[dv] [nvarchar](max) NULL,
	[fecha_creacion] [datetime] NULL,
	[salt] [varbinary](max) NULL,
	[deleted] [bit] NULL,
	[action_type] [nvarchar](50) NULL
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  Table [dbo].[opciones]    Script Date: 10/11/2024 19:52:19 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[opciones](
	[id_opcion] [uniqueidentifier] NOT NULL,
	[id_categoria] [uniqueidentifier] NULL,
	[nombre] [nvarchar](max) NULL,
	[deleted] [bit] NULL,
PRIMARY KEY CLUSTERED 
(
	[id_opcion] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  Table [dbo].[organizacion]    Script Date: 10/11/2024 19:52:19 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[organizacion](
	[id_organizacion] [uniqueidentifier] NOT NULL,
	[nombre] [nvarchar](max) NULL,
	[razon_social] [nvarchar](max) NULL,
	[direccion] [nvarchar](max) NULL,
	[codigo_postal] [int] NULL,
	[digito_verificador] [nvarchar](max) NULL,
	[fecha_creacion] [datetime] NULL,
	[deleted] [bit] NULL,
PRIMARY KEY CLUSTERED 
(
	[id_organizacion] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  Table [dbo].[organizacion_usuario]    Script Date: 10/11/2024 19:52:19 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[organizacion_usuario](
	[id_organizacion] [uniqueidentifier] NULL,
	[id_usuario] [uniqueidentifier] NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[publicacion]    Script Date: 10/11/2024 19:52:19 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[publicacion](
	[id_publicacion] [uniqueidentifier] NOT NULL,
	[id_usuario] [uniqueidentifier] NULL,
	[id_tipo] [uniqueidentifier] NULL,
	[titulo] [nvarchar](max) NULL,
	[descripcion] [nvarchar](max) NULL,
	[historia] [nvarchar](max) NULL,
	[ubicacion] [nvarchar](max) NULL,
	[fecha_creacion] [datetime] NULL,
	[deleted] [bit] NULL,
PRIMARY KEY CLUSTERED 
(
	[id_publicacion] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  Table [dbo].[publicacion_opciones]    Script Date: 10/11/2024 19:52:19 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[publicacion_opciones](
	[id_publicacion] [uniqueidentifier] NOT NULL,
	[id_opcion] [uniqueidentifier] NOT NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[publicacion_tipos]    Script Date: 10/11/2024 19:52:19 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[publicacion_tipos](
	[id_tipo] [uniqueidentifier] NOT NULL,
	[descripcion] [nvarchar](max) NULL,
PRIMARY KEY CLUSTERED 
(
	[id_tipo] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  Table [dbo].[rol]    Script Date: 10/11/2024 19:52:19 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[rol](
	[id_rol] [uniqueidentifier] NOT NULL,
	[nombre_rol] [nvarchar](50) NULL,
PRIMARY KEY CLUSTERED 
(
	[id_rol] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[tablas_dv]    Script Date: 10/11/2024 19:52:19 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[tablas_dv](
	[nombre_tabla] [nvarchar](50) NOT NULL,
	[DV] [nvarchar](max) NOT NULL,
 CONSTRAINT [PK_tablas_dv] PRIMARY KEY CLUSTERED 
(
	[nombre_tabla] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  Table [dbo].[terminos]    Script Date: 10/11/2024 19:52:19 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[terminos](
	[id_termino] [uniqueidentifier] NOT NULL,
	[descripcion] [nvarchar](max) NULL,
PRIMARY KEY CLUSTERED 
(
	[id_termino] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  Table [dbo].[traduccion]    Script Date: 10/11/2024 19:52:19 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[traduccion](
	[id_idioma] [uniqueidentifier] NULL,
	[id_termino] [uniqueidentifier] NULL,
	[traduccion] [nvarchar](max) NULL
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  Table [dbo].[usuario]    Script Date: 10/11/2024 19:52:19 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[usuario](
	[id_usuario] [uniqueidentifier] NOT NULL,
	[nombres] [nvarchar](max) NULL,
	[apellidos] [nvarchar](max) NULL,
	[dni] [nvarchar](max) NULL,
	[email] [nvarchar](max) NULL,
	[telefono] [nvarchar](max) NULL,
	[clave] [nvarchar](max) NULL,
	[fecha_nacimiento] [datetime] NULL,
	[direccion] [nvarchar](max) NULL,
	[codigo_postal] [int] NULL,
	[dv] [nvarchar](max) NULL,
	[fecha_creacion] [datetime] NULL,
	[salt] [varbinary](max) NULL,
	[deleted] [bit] NULL,
	[verified] [bit] NULL,
	[id_idioma] [uniqueidentifier] NULL,
PRIMARY KEY CLUSTERED 
(
	[id_usuario] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  Table [dbo].[usuario_preferencias]    Script Date: 10/11/2024 19:52:19 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[usuario_preferencias](
	[id_usuario] [uniqueidentifier] NULL,
	[id_opcion] [uniqueidentifier] NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[usuario_rol]    Script Date: 10/11/2024 19:52:19 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[usuario_rol](
	[id_rol] [uniqueidentifier] NOT NULL,
	[id_usuario] [uniqueidentifier] NOT NULL
) ON [PRIMARY]
GO
INSERT [dbo].[categorias] ([id_categoria], [nombre], [deleted]) VALUES (N'71fa28cb-62f8-40a0-9a48-9240a0af7221', N'Raza', 0)
INSERT [dbo].[categorias] ([id_categoria], [nombre], [deleted]) VALUES (N'08edcadb-e5b7-4481-8e16-d0e7bf84e8b9', N'Tamaño', 0)
INSERT [dbo].[categorias] ([id_categoria], [nombre], [deleted]) VALUES (N'ff301f4d-bfcf-40ac-9885-fa9ff17afa83', N'prueba', 1)
GO
INSERT [dbo].[idiomas] ([id_idioma], [descripcion]) VALUES (N'0dac9c9c-b1c3-4ff5-9b85-595427e6210c', N'español')
INSERT [dbo].[idiomas] ([id_idioma], [descripcion]) VALUES (N'76f72094-889c-4b45-979f-7b2a34926430', N'ingles')
GO
INSERT [dbo].[log_usuario] ([id_log], [id_usuario], [accion], [fecha]) VALUES (N'00000002-c0e1-794b-63c8-7ec3551b1321', 0x02000000EE5CB18BFCB4B13CB85FAE72758E452CE1CA00915D60077E43395AB91B128D8D0D03F923275415D3D0AA15885B470DB47E37A5B77D3617EE52CB26994A2D0F56FB6439EF33684376CD5258FAE5D2C72478395985BF346B941344B35AC0DE3930C50D51FCA441A4671FEBD032AF4D3E99, 0x02000000F141563E97D49EF46C661447DF760B3934C713A57E466722B04F79B6D14A8425C8BA0FB9DC3DDB2DCACB888B59A77DD4, 0x02000000FED6AA80C003477DF1466FF004B5C76B4E9AD31D6890B6E38B2B224E7A052A72E3A88848B64980EC5065A5B8DF85CB6579CFAFC35FAC8E3F6EF4E052854B9082)
INSERT [dbo].[log_usuario] ([id_log], [id_usuario], [accion], [fecha]) VALUES (N'00000002-91ea-c8d7-34fc-b87e08e7bc6b', 0x020000007A5F7E5755E9D395B467EA5666A29AD1EFCCDE9EFB1D6AE5D6E2D1FBE97E5B48D3D280D98C6310E39BD0582F94172DCCB4421EA51BA6C664735596E30E0FED36C5790549A3138C6373464F8437B7F47FBE4A9F0970CB483A6CCB1D983A31102AEDEC250F60C7305AA37C5B066297600A, 0x02000000797EDEB8AF43E1CFC762F92D42188AAA49FD73BA77DB658531E810540CBBDBDCABADCE99C9F6A73A3F291E25799BE256, 0x020000000A282A319BB03CBC97AFE328E8C5C0D012308DD156CDFB59DB9DDD7E418930821E547D61709030A0799EBAA3416165E2F11C732D2BC7CBA888AFD0349080FA4F)
INSERT [dbo].[log_usuario] ([id_log], [id_usuario], [accion], [fecha]) VALUES (N'00000002-3c2f-b5ad-7fd4-cb4b7e5a8319', 0x02000000EE414FDB530B32442B51000200D5208A14A22A57F3B945CD22B3CE4B98564DDE9959AB75F3756C11044ED34C91F255F5DF6A5330E550116A66AD82A598EB6EE41BE01E4E22B32AC9A6C0CCC98BCD583ACD96A92336B395FF7A4959CF7C4C4DAC9C90CF2CF2A02A24A9FA6EAA5B9BDEE0, 0x02000000F89174A9B4FCA0C1782DA043C9DDF2E22E1AB60C11D8AC032DEAD5121AEC3491665BD5F54A1ACD59861FB987F35211CB, 0x02000000CF915AB9EF3044A5D3D35F12D56F88FBEC07275ABD8B458AC445843F16A42192E9D088237ACD4753F99078888A09BF254733F5E1009ACDE7AB2ED8295E5A463A)
INSERT [dbo].[log_usuario] ([id_log], [id_usuario], [accion], [fecha]) VALUES (N'00000002-5f58-a9c1-a666-610ec749d296', 0x020000007239A3137695CA9386FD2A449AD9984483CFF06723DC2F450F69D70C7BDDB52349896B154D6E00C99AE00FCC17680C66567701FC90AF2EE9DFD995AB49B4913DCA6F89DABA0BE20D413B72942D1C393772BCEC678563E4D13A71A828F2674DB3F625D2FE0A5CD64EE21E4E7F94A0EBDB, 0x02000000EB1FABC0B9FFF43DA93B05796DE7108916B00CBE331B89F2F65CEA3E68870B452D3E266195BC29146C1FCC6356259272, 0x020000008D85D43502E01352C0D8DEA9E552841E10B80651488A47F52257D34F4DDAB47D18200DCAA0B3D770523CB6DEE362E76BF263974E9D1B1F19AC73D8DA33D4D98D)
INSERT [dbo].[log_usuario] ([id_log], [id_usuario], [accion], [fecha]) VALUES (N'00000002-1a53-986c-4a4e-9e8752b3238d', 0x020000001DE0C0F1EAD579D7A1B5754E41079CA0BADB922EB96A2B6AFFF7BF3AF1112F524F36D7BD02C1BB5F4738C209ECC768F07F252DE18CC0D5A1DDFEB582A1A562170664415FC7C5F658253593736A8BC8E92C8AA9CB08964E3B78F9CE8D0B0B5B1CE918F3791E9F819E49D4174772E8CC88, 0x02000000F8DE789EFBC1D0F99D3F3D482FDF053C3E72B74AD7B59B6EAE7E07516C3FFACE0E4E3840F2015B2B9500C9BFEFFF4537, 0x0200000020A40CF7977FE23B1F76819F9A5367839E13A10EF9CA2B65CB161263EC303E9394FC70F54E54B465F7494BA267E2BA2ACDD7F49D23341A5EC2F8C7EBC950D088)
INSERT [dbo].[log_usuario] ([id_log], [id_usuario], [accion], [fecha]) VALUES (N'00000002-c025-f9aa-b656-2845a73dcbc2', 0x0200000074F6F2560ADD93123807B2A000BBBEB804F8CA24C808F3E325E04A4134297457FC970D77068B7DD96D421C58770E5FBF60D9548A0D5590E03FF0CDAE26DCE0B18C29ED2E0E032D16DB90B235BB6E34373C17D69AFC5DCCCC7ADC7324353C89AD2DD9552D7BE93DBC1C4A43A284EBDA1C, 0x020000009C04AB4FA64EF7417FBE1249E407D38063D9404A4F80B836BE01447D1320F9943E3231467A3F4CE752A7A787C756FE65, 0x0200000022AA741F1A5CAEB7B50FFC3D1C695AAE46B44F237D1DA90A91B9EE95D217021F87E40391411536FF644949477288586D86E26AEA88E5BB08E37518702308FBC7)
INSERT [dbo].[log_usuario] ([id_log], [id_usuario], [accion], [fecha]) VALUES (N'00000002-f284-42f2-3861-add7f4be6463', 0x02000000FE6253C89C6C86BBF89DEF605A31B82FCCE2FEC2651AC83873E0997EC96CFD0F7F3ED5B955C992F6F1BD001AA39F972AA4CCE437D86797671A7381C25E138A6A40EA34B06A4BA933DA6BB041C260BFA3F8F379AEBFB4BECB5B95E0D608C0370591942A1F76FA80A72F29C5E41015A857, 0x02000000BF5F21E770BB8460B0B218F1DA1C643BF4CDF9124AA4DFD84A4167FE01711367217DD7E7BD962AF6A997FF70C7CE9901, 0x02000000B75F8CC953715FCD89B0A8F80C244CA60942F1A2B2BBEECB546EC215BF48ADE96ADDE14BEB81A73417C55FABAE7298240DAFA98F4163AAA35A61086C7BE2F6E0)
INSERT [dbo].[log_usuario] ([id_log], [id_usuario], [accion], [fecha]) VALUES (N'00000002-730b-1de6-f78b-d785b0fdb186', 0x02000000A32A65E72BA049BD34D0FB7DAFAFF96DAC14BB67B2690B9C97770EB22FBC1B869190CE6D8B1157742EB07A7A17D8BF1431E3C6816A73F0AF050EE2B82EFF267FD58CB287DA9838050A07C0CFF0D0D2208F613F556A40A1E1F67F77C1386D33BF24FB8F467796CB47AF7F3ED148610EC9, 0x02000000968BAA4BD3BBA79A223DF6CCCD5BFFC5D0FBA435D7C30726BE4E2CF204B88835F90D13BB342A7037D3FD87999E3DB91B, 0x02000000812FE0F80AE3D2C0FF5F006485D15A3F70B8A33A2EE2968A7CD9E0F45FF0EA8B5B5EAFEE10845ED9F959C11D702EEE4B4A5F6612D24F636F7AEBAADBE588CFA4)
INSERT [dbo].[log_usuario] ([id_log], [id_usuario], [accion], [fecha]) VALUES (N'00000002-17d7-6c5a-60b7-cc6c8d1fa93a', 0x02000000A883163827D0964406923A5D50249CC3D3361B4C6F70BEBF4D0EFE6101048F1F4E466B9AAA696332CA51ED69B036DA6663AF8753D1BBB5B95B4E8D0DEC72AD91B261B0D59208564DAA468AF1CA9DD47FD254BD8EB76A049A2314DEDF04B0F132D8ECDBE2A407D226CB65ED4CCC8C0FB7, 0x0200000079B302C9EDB98B2097FEEAF6FA81AECA8D5EFA5E6DB1560AE8CE904599CC57622D7500CE5B00480EF93FAD45AD5409A6, 0x02000000158756C4C63656082BE8ECCC576DFB157D47CFD30DC8BD9FB7DC6F567CCC9428DB46B17337549AED1BE12F321E6AADEFB5B94B338F02027310368F7410CEA88D)
INSERT [dbo].[log_usuario] ([id_log], [id_usuario], [accion], [fecha]) VALUES (N'00000002-3233-fdfa-ebd7-de8a4be5a290', 0x02000000664F86B1697295B158749FD18E6139E2B20F8B39340ADA519B32C4C5443C6292681B79DAE5FD7949CB69CFCA45C3AA126ABFF30A965556CAA4E7D44C8A52824376B519BC7848E62155C5101C8DAF8148FDF715367FC2A482BEC53BD41E2E1528F185453CC90B20D26158A95C8EA1D92E, 0x02000000C129A765E10204AAC8FA27925B42D61DA51481E90FA64FDCCAB565A59D61186EA806AFAE6CAEDC5A2EAE9F63E9FA6D9D, 0x0200000029891354D2CAFFA453D101A2AA30928304065D39339FCCB218C98E6E179F59E375F338D21B0DC1EC65CCA5AC33E3DFE5E8F99CB0DB68BC03100896AD12D431E9)
INSERT [dbo].[log_usuario] ([id_log], [id_usuario], [accion], [fecha]) VALUES (N'00000002-968c-812e-4fcd-88b6f9e60534', 0x02000000F60C59586715CC58A20CE742EA207C0F872E4CEE9E6F44004A5C44E05EB9D7F4F9D5436DA3FDB10CC633BFF759064D29F0CDAED38DAD11B3EB9D4ADA4E314D25E2395B9BFDC3DBA971BA7006DE87A67A12DDC13669F97D8E45E0CDD272D39A5616FAB246B8D2882C903645F303A7C726, 0x020000003C5A7F545E759E84DA768A83AA89F1BFA54FC7769E72A269D477EBFEAC645E13A5518AEF9EA5104DFE22500D2A01E1D9, 0x02000000B02DDA57DA259A2ABF3ACB63F24F2D0DD174E486F54DF95723609FA27CF705ECD5C70E0A5FE5D34064811037CDDE0DF86EF8E4B82C408F2540F2139E114CE668)
INSERT [dbo].[log_usuario] ([id_log], [id_usuario], [accion], [fecha]) VALUES (N'00000002-3d10-a136-dca0-76087c410092', 0x020000002E73626F9C674DB2EBB493A074F14933571649611F855B838B07DB309270EE0A5D4542AEC62ED4B572E5DA720083D9079EE96450C05D6A9D862F9757D4485F444045C21695E7FF8477AECEC36A5A98DA4987F1F632A0AEC1C0ACC6FBDEB1CCB9DB3104E8DA0F940775E2F66B6B34AC4E, 0x02000000169F02D08557B8FFBAA7DECD48A0DEE293A7A8CB3C4C4677C5A621C6A7CD04F0ABF5856A66CF947642732336791B3354, 0x02000000EC588EEAA6547BB32D0425FF6664E812227042EB5222CAE7A901ABF4700A132FBABFD2173F9926144B81ED65D9F2CBF99B744184CB2E444C9AB5493D071C0D98)
INSERT [dbo].[log_usuario] ([id_log], [id_usuario], [accion], [fecha]) VALUES (N'00000002-e990-0d38-0655-3494c7400c78', 0x020000005286520D902F51E5E509DED7AB9593B474C0DD5C92DAE4A245D825EF221E19AC773F974F157DDB55F91D5F87AFF339FB3BF4B507FEAB746A187E7208DA088CE525922001A0A9F10B3CFF8E82240D6D72106520DAD58463598685ADCE16378157763595062B3DF2C33C5BD242937ED13F, 0x020000007DD8B8905C428F52857B5F9759403FAEAD755230D9A589AB09E31DFF96D0F4EC6D0515C949FD994C1D31F53F6ACA7374, 0x020000007D6AB4B87EFD2566D4EF408B2B0200D0688A701379C7973DBC13C12B613EAF90CC6410E7EA58DBA0DEA7B97467BD183189156BFB21A0BB1B7533B9C27379D15B)
INSERT [dbo].[log_usuario] ([id_log], [id_usuario], [accion], [fecha]) VALUES (N'00000002-4452-89f8-38b4-e42bf738c7b6', 0x02000000EDF1F1C3F2AD3B347F4431795D8B5AB67BF413A3B93B4052CFB91A95BC620A5FD6918098F0C2A81EA0B873173AF4257EF2A0E8FA40CA426F264FEA4CE6BCCEB68DDA02E881F4A6B8D534F033047BF46BB2EA2D69D8259F2F309BD9B1CC52C8D30DFFCD8C684DE9D5526BC98EFF00B28E, 0x02000000D2D044C9839DED1854AE96E4467C5A38DDAFE55A7767E9AC8A9DF647F0F3E1C7277F34B99E722224F126A446FB98DE41, 0x02000000FCFF28A8DBAB9E412A55872AA702205F48A87E13910BA6F0E708387BAA21859FA978F183643AE1B9ED6848FEF277E21DA41EF4CCC203718775D4E6B13EF5FC73)
INSERT [dbo].[log_usuario] ([id_log], [id_usuario], [accion], [fecha]) VALUES (N'00000002-eb0b-8193-0d63-f176e429311e', 0x02000000B22E4581F3E868740D7533D5C3F391975E626664110A937CF6FE7A2D2861E19F887FD1CE1FE167A932480C1A261F429D1380A4BF087780C0C84B3791026B01A07F300B5104BAA8FE23642E43DBED4770EB66BE8E97030A0D5398C60787B52033C04EEBF61E97EE2F6C8BEE626340A546, 0x02000000FDE4330A48BCF3015CD3B9926BEBBBBC9E99911BDEFA8A997FF6A81AF81C4B74E2BA2D60B99F858B0EA03BA945A2B2FD, 0x0200000082FDA5A921A80B062FCCFDF9C9E4E78D988613281F4B578F1883FD52387DA520B28D441CD10887B8EB86D7DBE49D2D1CB9E0B3EE433E2EF5FC55FFCEE200A573)
INSERT [dbo].[log_usuario] ([id_log], [id_usuario], [accion], [fecha]) VALUES (N'00000002-6e54-024f-4480-08d6366d569e', 0x02000000A4698D7A283411839BA902FE26F3F03FB0C0782206458ED0D8CA122BA00270C25C62A2F8A9C13A5ECBDD53F2810B9B57EE149921533B1168F6981D04F4E90CF896F15D7EDFA7E910DE7A14F1C5E83EC65429CBDE346D600CCD8C4311636F3E49C1CBA1F8F3552D249F73D06A242C0097, 0x020000003AAFA2ECF497817FBF7E34EE68C6F67470BABCADB35C2B9AA630BB0D8FCECEF5FDAFCD184557D5F6ADF11B347C26A9A2, 0x02000000E7A81FC3B0A22899E276539B2F7BB263FDC751211C237C37ED343AC5F2AE60D98E607DA61B76B4EC56C2B751CABEC5EF8D84DAFCBBCC37A8D180713D940AF926)
INSERT [dbo].[log_usuario] ([id_log], [id_usuario], [accion], [fecha]) VALUES (N'00000002-3c69-3922-7f8f-533e3ea74fb6', 0x020000009D00FE89617730ACBCE0FE5A505549BD920D0B02C110822385C98DBBC1A0FA4F09130AC253973436B21CC6C2681BC3D36E5CBB0C52077E1BC73321D3FF25118523DB73925A546538E24D256227717AFDB2649BE51DC01ACF98CEEA5403F5080891C8354CF7040C92EEB7B411483828EF, 0x020000001A3B85FAFC37BDA0DC8EDDA6890D9F38911CB862FFF1D75FE4E3DD1362AC6DEBEF93D7BC9BD00BA388C008A7FCBA72CF, 0x020000004406948347C257F84C896DFAADE25D02A002DAB78D398899C7C7DB221332D0380690FBE9C3334014AEFFC52C510DF3FE7468B89B7E0117BD8AC3AFB082328E92)
INSERT [dbo].[log_usuario] ([id_log], [id_usuario], [accion], [fecha]) VALUES (N'00000002-734b-aa88-2927-d8415c4fe0cd', 0x0200000034395DB272403C2ACE4CBD45CC0576B35333D176B2711361AF277F9BC67DA4BC21E765CB1E15CFB5507B30A13D15B1AA4F54D352ED5EB51D9DF0A9E3887A41AE85609B0E21BFDD3D3164CBFE586E939D9968DBA502CF72A340F0455336DDFB0BAAC55FADBCE1E1A4BA99B28D61C89151, 0x0200000055C613C4D969855B950AC0C238D29A73E9FE51AE44FB48C1061D89A5D3F2E7498185857F01051A58D506905113E278DE, 0x020000009C0A58934D22F64DEC3B54F9BF2E482A2042096AD98594BF0CF3541893AAB06BEA1CECDFAB49B38CA5B70E52F505A819EA09EEA56258D531AEF590137C6FC911)
INSERT [dbo].[log_usuario] ([id_log], [id_usuario], [accion], [fecha]) VALUES (N'00000002-6d11-aa96-8c66-292d7bed70be', 0x020000001CE9D5DDED895F221BF3470B11921F3F02E50E744B4A2EA6C7F2E8C4A410C581C3AB068380E235351CD48521E38298F5AA79F9C5DF0D269584DB09EF20D179CA8A90EB67698C271B748FAB13117D36F7E049A4802388F76FA788A5C79B8699B38EA54420049381FE3D785815CBB0A79A, 0x02000000614BEFF08648B4E0DF8ED1915F520A393442A2D0340CE41A6ED27B658A53B56C1754CEB696299503354CB75F8CDE89C1, 0x020000003241915BA29C2A48C604B419210DC2213F2A373FD16C76A648359D06D16250F57CECFED663A94664BAEF11C2B50FDE6409555F368437620DA9186F8D4879BD85)
INSERT [dbo].[log_usuario] ([id_log], [id_usuario], [accion], [fecha]) VALUES (N'00000002-cfc7-fc9c-504e-ad0fcbd06519', 0x02000000843183A1DCC738B4F55EE6E8197222D5F5073879E5EF226218820FC6C4A4F48D62B42A35A7C55757AAC0234B768D1DF108CD739228961CB0FC5DDA881FF5B93ADA649250EFD769A3E61204EF2C55AF1716D64F83E4A1D8E1F63BA252E4EF2224DFAA7770B226BA153C82ED6D4F617ECD, 0x020000009E351899C238EA81F3CE03E513B86AC6A0549B926B6C4E9FBAB2E1F5ECF108E3695A825D5C454DB96C383C0C6BBF5C69, 0x020000005E3B73CB84DDFEAEAD29B88C39E6F2320023DE1A559A6DDF834CC21FDE70FADFBD2538767EB775D56FD5BE90E8D8118B037D9C07C5E6F06D38D5410FC0C57D6D)
INSERT [dbo].[log_usuario] ([id_log], [id_usuario], [accion], [fecha]) VALUES (N'00000002-cb0b-48f2-c9a9-3e74656064b5', 0x02000000B484315CA7CA3732CA6D103A38914728D59D71797046CB029AEFC6F32D587D1AFB25F4187268313371E02605E9BFF8E05B4E3F2F179454350363619E8F6785318595A16D75471CB06FA4E39E5EEBAEA9386C7341A5EE4EA2145424DF1E89EFB4EBBF69CD095C1A018E950B2A980DC07D, 0x02000000C10AD869387DB14A9C888E592B1ED238765874CCF940089BA29376CCA3B99B3FF9926778CEA0848F27689F8DA03A00E5, 0x0200000078E930E263033C999EE5FDA46ABD5BD9667918B5ED6025733C255C7A30937FF326C42C9507D15F234AED06EDF0EF275CAADDF50F8CFC208F3BB6AEBFA3F34C7A)
INSERT [dbo].[log_usuario] ([id_log], [id_usuario], [accion], [fecha]) VALUES (N'00000002-02c8-32c2-dd93-0e0dea8c232a', 0x02000000A33F15B2D5AA815B74C2EB6DE3C350A27C1132D8BC845197AD07D5CA5FD69A5279288959A7530E8D055A1DA8A6523ABC430E5DCADA91003A21C675740190C382714F057CDB98943834CD527ACC4AEBC807B00C41C15C7A5C2C67A2F0D6DF79711CF42E9C6A05916762AD832038BAC18E, 0x02000000B1DB768CFFB755FB3AC0B66B36F119E6EE365FAE7F8BC30D4A15BDE467BB5EDB1EAAABE8B3797B4775638EEA9D85A903, 0x020000003D90DD2F5FB167EB9F4315BF4D53A7994E96D83D38438F8A5529722280BC156BD0602F098C958A39E5415877E222764104E1E52653BCCDC8C05FA9E5CAB2A9DA)
GO
INSERT [dbo].[mirror_usuario] ([id_usuario], [nombres], [apellidos], [dni], [email], [telefono], [clave], [fecha_nacimiento], [direccion], [codigo_postal], [dv], [fecha_creacion], [salt], [deleted], [action_type]) VALUES (N'd4d03654-9efe-484b-9b55-3758d50a68df', N'a', N'p', N'122112123', N'prueba@gmail.com', N'1212121', N'QnykniBs27kFbIRq1vC0qbS9BThUVLjMJkaZ6YOs5LR4NmrcF8nloJ/6YPDNxLXT', CAST(N'2024-07-02T18:38:44.797' AS DateTime), N'nkjsandkjsan', 1221, N'bHYudHVasx3xkv6UVMrrQQ==', CAST(N'2024-07-02T15:40:18.250' AS DateTime), 0x427CA49E206CDBB9056C846AD6F0B4A9, 0, N'Modified')
GO
INSERT [dbo].[opciones] ([id_opcion], [id_categoria], [nombre], [deleted]) VALUES (N'ec2e4d07-88fb-4da8-9d64-1a88394c7d8e', N'71fa28cb-62f8-40a0-9a48-9240a0af7221', N'Labrador Retriever', 0)
INSERT [dbo].[opciones] ([id_opcion], [id_categoria], [nombre], [deleted]) VALUES (N'0f291510-db62-400e-969d-22f073d363e8', N'08edcadb-e5b7-4481-8e16-d0e7bf84e8b9', N'Gigante', 0)
INSERT [dbo].[opciones] ([id_opcion], [id_categoria], [nombre], [deleted]) VALUES (N'd38bd9f5-2cf5-443a-9b8d-2c99f4fe61d2', N'71fa28cb-62f8-40a0-9a48-9240a0af7221', N'Border Collie', 0)
INSERT [dbo].[opciones] ([id_opcion], [id_categoria], [nombre], [deleted]) VALUES (N'99f56df1-c540-46ec-8f9b-32d0724e5ecb', N'71fa28cb-62f8-40a0-9a48-9240a0af7221', N'Dachshund', 0)
INSERT [dbo].[opciones] ([id_opcion], [id_categoria], [nombre], [deleted]) VALUES (N'828801b7-62ec-4c45-9ed1-35d5ef06877a', N'08edcadb-e5b7-4481-8e16-d0e7bf84e8b9', N'Mediano', 0)
INSERT [dbo].[opciones] ([id_opcion], [id_categoria], [nombre], [deleted]) VALUES (N'b8bde21d-baec-4e81-9ffc-4ef71fcd09e6', N'08edcadb-e5b7-4481-8e16-d0e7bf84e8b9', N'Grande', 0)
INSERT [dbo].[opciones] ([id_opcion], [id_categoria], [nombre], [deleted]) VALUES (N'45166b69-f847-4f75-8b22-4fa27b277d65', N'71fa28cb-62f8-40a0-9a48-9240a0af7221', N'Golden Retriever', 0)
INSERT [dbo].[opciones] ([id_opcion], [id_categoria], [nombre], [deleted]) VALUES (N'd9879d62-4a0b-4034-bcc6-799d64363173', N'71fa28cb-62f8-40a0-9a48-9240a0af7221', N'Pastor Alemán', 0)
INSERT [dbo].[opciones] ([id_opcion], [id_categoria], [nombre], [deleted]) VALUES (N'e2ba8aec-6d72-4d1d-91e2-7aea121d36ac', N'71fa28cb-62f8-40a0-9a48-9240a0af7221', N'Doberman', 0)
INSERT [dbo].[opciones] ([id_opcion], [id_categoria], [nombre], [deleted]) VALUES (N'c3b46b2f-ab62-4ac4-be12-87f219ae2155', N'71fa28cb-62f8-40a0-9a48-9240a0af7221', N'Beagle', 0)
INSERT [dbo].[opciones] ([id_opcion], [id_categoria], [nombre], [deleted]) VALUES (N'4da9c633-4f99-4523-acf8-98125d6e0ad2', N'71fa28cb-62f8-40a0-9a48-9240a0af7221', N'Poodle', 0)
INSERT [dbo].[opciones] ([id_opcion], [id_categoria], [nombre], [deleted]) VALUES (N'289cd4b4-8e84-47d6-a4ff-a119dfbd6dc5', N'08edcadb-e5b7-4481-8e16-d0e7bf84e8b9', N'Pequeño', 0)
INSERT [dbo].[opciones] ([id_opcion], [id_categoria], [nombre], [deleted]) VALUES (N'202e185a-43e7-4534-85a0-a707ada1e297', N'71fa28cb-62f8-40a0-9a48-9240a0af7221', N'Shih Tzu', 0)
INSERT [dbo].[opciones] ([id_opcion], [id_categoria], [nombre], [deleted]) VALUES (N'7e39f493-8a6c-4cfc-a7ee-adca84267537', N'71fa28cb-62f8-40a0-9a48-9240a0af7221', N'Mastín', 0)
INSERT [dbo].[opciones] ([id_opcion], [id_categoria], [nombre], [deleted]) VALUES (N'df2428db-42f6-42f4-a229-bc2f23842445', N'71fa28cb-62f8-40a0-9a48-9240a0af7221', N'Husky Siberiano', 0)
INSERT [dbo].[opciones] ([id_opcion], [id_categoria], [nombre], [deleted]) VALUES (N'a4238f2e-6e66-4161-a581-ce7171dc5e05', N'71fa28cb-62f8-40a0-9a48-9240a0af7221', N'Pug', 0)
INSERT [dbo].[opciones] ([id_opcion], [id_categoria], [nombre], [deleted]) VALUES (N'85204901-debb-40c6-a2ba-d29825e45e8b', N'ff301f4d-bfcf-40ac-9885-fa9ff17afa83', N'prueba', 1)
INSERT [dbo].[opciones] ([id_opcion], [id_categoria], [nombre], [deleted]) VALUES (N'3381c966-7a75-4372-8053-d8da5d5e7739', N'71fa28cb-62f8-40a0-9a48-9240a0af7221', N'Dálmata', 0)
INSERT [dbo].[opciones] ([id_opcion], [id_categoria], [nombre], [deleted]) VALUES (N'bb5224cb-9689-48d0-975e-da10792ea529', N'71fa28cb-62f8-40a0-9a48-9240a0af7221', N'Yorkshire Terrier', 0)
INSERT [dbo].[opciones] ([id_opcion], [id_categoria], [nombre], [deleted]) VALUES (N'65b74cf2-8952-4084-92dc-dfb48b96a462', N'71fa28cb-62f8-40a0-9a48-9240a0af7221', N'Rottweiler', 0)
INSERT [dbo].[opciones] ([id_opcion], [id_categoria], [nombre], [deleted]) VALUES (N'7f571dc4-fc16-4b26-860d-e621bf491417', N'71fa28cb-62f8-40a0-9a48-9240a0af7221', N'Boxer', 0)
INSERT [dbo].[opciones] ([id_opcion], [id_categoria], [nombre], [deleted]) VALUES (N'f17f1753-1cc8-42c6-9baf-eadc29dc13a9', N'71fa28cb-62f8-40a0-9a48-9240a0af7221', N'Bulldog', 0)
INSERT [dbo].[opciones] ([id_opcion], [id_categoria], [nombre], [deleted]) VALUES (N'9858e256-9d24-42d0-bf42-f1cdedc8f003', N'71fa28cb-62f8-40a0-9a48-9240a0af7221', N'Chihuahua', 0)
INSERT [dbo].[opciones] ([id_opcion], [id_categoria], [nombre], [deleted]) VALUES (N'557f40a0-8e99-4b6a-a20f-fbc0df4823a0', N'71fa28cb-62f8-40a0-9a48-9240a0af7221', N'Akita Inu', 0)
GO
INSERT [dbo].[organizacion] ([id_organizacion], [nombre], [razon_social], [direccion], [codigo_postal], [digito_verificador], [fecha_creacion], [deleted]) VALUES (N'b34a7d3d-1c31-44ed-aa79-80b7d358488f', N'Traverso prueba', N'1122122323', N'Jose Maria Paz 332', 1715, N'13V9V1nqBXo9xAqI1AbLEA==', CAST(N'2024-11-10T18:09:53.950' AS DateTime), 0)
INSERT [dbo].[organizacion] ([id_organizacion], [nombre], [razon_social], [direccion], [codigo_postal], [digito_verificador], [fecha_creacion], [deleted]) VALUES (N'a6bd624b-51e1-4694-81cb-b0ec26aaec27', N'Cachorritos org', N'3332332333', N'Brandsen 1721', 1432, N'wqkJyz2WECaPfnTQ7jhCxA==', CAST(N'2024-11-10T18:16:20.067' AS DateTime), 0)
GO
INSERT [dbo].[organizacion_usuario] ([id_organizacion], [id_usuario]) VALUES (N'b34a7d3d-1c31-44ed-aa79-80b7d358488f', N'7c08c969-f7ce-4d8a-a51c-6f648304c3fa')
GO
INSERT [dbo].[publicacion_tipos] ([id_tipo], [descripcion]) VALUES (N'61d50007-7d29-4489-8cfb-2f315b5e4c03', N'Adopcion')
INSERT [dbo].[publicacion_tipos] ([id_tipo], [descripcion]) VALUES (N'3623964e-d8e3-4e30-837d-693fe2a2131f', N'Perdido')
GO
INSERT [dbo].[rol] ([id_rol], [nombre_rol]) VALUES (N'05953c7e-3250-49b5-89c3-3c44c2d46a83', N'User')
INSERT [dbo].[rol] ([id_rol], [nombre_rol]) VALUES (N'cb99df75-be41-4bb6-a714-60a4416be942', N'Admin')
INSERT [dbo].[rol] ([id_rol], [nombre_rol]) VALUES (N'47066668-03b1-4510-9d0d-ab466c550c68', N'Webmaster')
GO
INSERT [dbo].[tablas_dv] ([nombre_tabla], [DV]) VALUES (N'usuario', N'JRAYxCZnlbDCDFSU8Atz6A==')
GO
INSERT [dbo].[terminos] ([id_termino], [descripcion]) VALUES (N'53e988d3-161b-40c6-ac66-075eaea55734', N'publicar')
INSERT [dbo].[terminos] ([id_termino], [descripcion]) VALUES (N'fc088916-7420-421a-ada3-6a778cc6f2fb', N'cerrar sesion')
INSERT [dbo].[terminos] ([id_termino], [descripcion]) VALUES (N'd72c2d7e-7402-4e9d-9850-c2b37e518ece', N'bienvenido')
INSERT [dbo].[terminos] ([id_termino], [descripcion]) VALUES (N'e5055c05-fc1f-47ae-83c7-c9775adcfad2', N'ingresar')
INSERT [dbo].[terminos] ([id_termino], [descripcion]) VALUES (N'3a44c350-006a-4a55-a491-cbf374b07da6', N'configuracion')
GO
INSERT [dbo].[traduccion] ([id_idioma], [id_termino], [traduccion]) VALUES (N'0dac9c9c-b1c3-4ff5-9b85-595427e6210c', N'53e988d3-161b-40c6-ac66-075eaea55734', N'Publicar')
INSERT [dbo].[traduccion] ([id_idioma], [id_termino], [traduccion]) VALUES (N'0dac9c9c-b1c3-4ff5-9b85-595427e6210c', N'fc088916-7420-421a-ada3-6a778cc6f2fb', N'Cerrar Sesion')
INSERT [dbo].[traduccion] ([id_idioma], [id_termino], [traduccion]) VALUES (N'0dac9c9c-b1c3-4ff5-9b85-595427e6210c', N'd72c2d7e-7402-4e9d-9850-c2b37e518ece', N'Bienvenido')
INSERT [dbo].[traduccion] ([id_idioma], [id_termino], [traduccion]) VALUES (N'0dac9c9c-b1c3-4ff5-9b85-595427e6210c', N'e5055c05-fc1f-47ae-83c7-c9775adcfad2', N'Ingresar')
GO
INSERT [dbo].[usuario] ([id_usuario], [nombres], [apellidos], [dni], [email], [telefono], [clave], [fecha_nacimiento], [direccion], [codigo_postal], [dv], [fecha_creacion], [salt], [deleted], [verified], [id_idioma]) VALUES (N'46625f0d-cb78-43cc-8327-35dcd26326cf', N'juanca x3', N'perez', N'112233', N'perez@gamil.com', N'1211212121', N'UTfZhgCIgkfmxq0NeSGMbKaZl7NT4C9yf8tisOoHF+MS3HZkxlZuBmAJi2kHYjJX', CAST(N'2024-06-29T22:27:33.183' AS DateTime), N'sdjnskjdn', 11222, N'9FqpF/F/BG+l0JLuQjJiXQ==', CAST(N'2024-06-29T19:28:16.757' AS DateTime), 0x5137D98600888247E6C6AD0D79218C6C, 0, NULL, NULL)
INSERT [dbo].[usuario] ([id_usuario], [nombres], [apellidos], [dni], [email], [telefono], [clave], [fecha_nacimiento], [direccion], [codigo_postal], [dv], [fecha_creacion], [salt], [deleted], [verified], [id_idioma]) VALUES (N'd4d03654-9efe-484b-9b55-3758d50a68df', N'', N'', N'', N'prueba@gmail.com', N'1212121', N'QnykniBs27kFbIRq1vC0qbS9BThUVLjMJkaZ6YOs5LR4NmrcF8nloJ/6YPDNxLXT', CAST(N'2024-07-02T18:38:44.797' AS DateTime), N'nkjsandkjsan', 1221, N'bHYudHVasx3xkv6UVMrrQQ==', CAST(N'2024-07-02T15:40:18.250' AS DateTime), 0x427CA49E206CDBB9056C846AD6F0B4A9, 0, NULL, NULL)
INSERT [dbo].[usuario] ([id_usuario], [nombres], [apellidos], [dni], [email], [telefono], [clave], [fecha_nacimiento], [direccion], [codigo_postal], [dv], [fecha_creacion], [salt], [deleted], [verified], [id_idioma]) VALUES (N'7c08c969-f7ce-4d8a-a51c-6f648304c3fa', N'Santiago', N'Villanovich Nasarre', N'43867151', N'santiagovillanovich392@gmail.com', N'1221212', N'3eeUsNV53FkqnVLRg6b/5OABc4I8MAZyE7klSHaaacj4uR8E9Re6I4txz6/u8Nwy', CAST(N'2024-02-14T03:00:00.000' AS DateTime), N'Udaondo 3886', 1314, N'r52UohT0ZAoDUGycJaVFlw==', CAST(N'2024-07-02T18:06:34.917' AS DateTime), 0xDDE794B0D579DC592A9D52D183A6FFE4, 0, NULL, NULL)
INSERT [dbo].[usuario] ([id_usuario], [nombres], [apellidos], [dni], [email], [telefono], [clave], [fecha_nacimiento], [direccion], [codigo_postal], [dv], [fecha_creacion], [salt], [deleted], [verified], [id_idioma]) VALUES (N'30396bdd-7f0f-4b45-955c-7d77347b9ec9', N'Gaston', N'Rousseau', N'12345678', N'gaston@gmail.com', N'112234553', N'S+KaRCGHrVasNV0IdgmZr0+4QUjUlQma7cCAo2gpPQQSfj5EGcwiMWcIIXdtFiqQ', CAST(N'2003-07-10T03:00:00.000' AS DateTime), N'dsjdsjks', 1232, N'LfeG30n0ZRi6PHrxRaWoMQ==', CAST(N'2024-07-16T21:12:08.680' AS DateTime), 0x4BE29A442187AD56AC355D08760999AF, 0, NULL, NULL)
INSERT [dbo].[usuario] ([id_usuario], [nombres], [apellidos], [dni], [email], [telefono], [clave], [fecha_nacimiento], [direccion], [codigo_postal], [dv], [fecha_creacion], [salt], [deleted], [verified], [id_idioma]) VALUES (N'9ed62706-5ad5-4404-9c23-eb09c17de41e', N'nombre', N'apellido', N'3237237723', N'jjsndjksdnjsd', N'121212', N'ivoP07bMd7AfwuI4JOkEc1/qpwviTOHOBt5EyFIXiZPYUSC/QE2s/kAy1SZ/RJMu', CAST(N'2024-07-02T18:53:36.463' AS DateTime), N'sndsjsdn', 1221, N'Kd7le4cq8xpKISeZBD4Fhg==', CAST(N'2024-07-02T15:54:15.133' AS DateTime), 0x8AFA0FD3B6CC77B01FC2E23824E90473, 0, NULL, NULL)
INSERT [dbo].[usuario] ([id_usuario], [nombres], [apellidos], [dni], [email], [telefono], [clave], [fecha_nacimiento], [direccion], [codigo_postal], [dv], [fecha_creacion], [salt], [deleted], [verified], [id_idioma]) VALUES (N'76fc82b5-9623-4afb-85c7-ecbedf6d4cff', N'RaulWeb', N'PerezWeb', N'23443245', N'webmaster@gmail.com', N'1123334435', N'c5esszCjMJ8Bm68AC4r60fMe9xyYFmeqja2yc0UwEo89BfR+Yk831ZKg8w8LDJpb', CAST(N'2024-07-14T23:15:46.257' AS DateTime), N'web', 1111, N'bYmj9atgGsAUEwPEJMOetw==', CAST(N'2024-07-14T20:25:53.933' AS DateTime), 0x7397ACB330A3309F019BAF000B8AFAD1, 0, NULL, NULL)
GO
INSERT [dbo].[usuario_rol] ([id_rol], [id_usuario]) VALUES (N'05953c7e-3250-49b5-89c3-3c44c2d46a83', N'd0be747f-372c-46c8-aeb1-9ca6afe9e58e')
INSERT [dbo].[usuario_rol] ([id_rol], [id_usuario]) VALUES (N'05953c7e-3250-49b5-89c3-3c44c2d46a83', N'46625f0d-cb78-43cc-8327-35dcd26326cf')
INSERT [dbo].[usuario_rol] ([id_rol], [id_usuario]) VALUES (N'05953c7e-3250-49b5-89c3-3c44c2d46a83', N'd4d03654-9efe-484b-9b55-3758d50a68df')
INSERT [dbo].[usuario_rol] ([id_rol], [id_usuario]) VALUES (N'05953c7e-3250-49b5-89c3-3c44c2d46a83', N'24ec2486-33cb-49ff-81b9-dc5826defe88')
INSERT [dbo].[usuario_rol] ([id_rol], [id_usuario]) VALUES (N'05953c7e-3250-49b5-89c3-3c44c2d46a83', N'9ed62706-5ad5-4404-9c23-eb09c17de41e')
INSERT [dbo].[usuario_rol] ([id_rol], [id_usuario]) VALUES (N'05953c7e-3250-49b5-89c3-3c44c2d46a83', N'7c08c969-f7ce-4d8a-a51c-6f648304c3fa')
INSERT [dbo].[usuario_rol] ([id_rol], [id_usuario]) VALUES (N'47066668-03b1-4510-9d0d-ab466c550c68', N'd4d03654-9efe-484b-9b55-3758d50a68df')
INSERT [dbo].[usuario_rol] ([id_rol], [id_usuario]) VALUES (N'47066668-03b1-4510-9d0d-ab466c550c68', N'76fc82b5-9623-4afb-85c7-ecbedf6d4cff')
INSERT [dbo].[usuario_rol] ([id_rol], [id_usuario]) VALUES (N'05953c7e-3250-49b5-89c3-3c44c2d46a83', N'30396bdd-7f0f-4b45-955c-7d77347b9ec9')
GO
/****** Object:  StoredProcedure [dbo].[bak_CreateBackup]    Script Date: 10/11/2024 19:52:19 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE PROCEDURE [dbo].[bak_CreateBackup]
    @path VARCHAR(256) -- path of backup files
AS
BEGIN
    SET NOCOUNT ON;

    DECLARE @fileName VARCHAR(256)
    DECLARE @name VARCHAR(MAX) = 'FindFiddo_App'
    DECLARE @fileDate VARCHAR(20)
    DECLARE @sql NVARCHAR(MAX)
    DECLARE @errorMessage NVARCHAR(4000)

    BEGIN TRY
        -- Especificar el formato del nombre del archivo
        SET @fileDate = CONVERT(VARCHAR(20), GETDATE(), 120)
        SET @fileName = @path + @name + '_' + REPLACE(REPLACE(@fileDate, ':', ''), ' ', '_') + '.BAK'

        -- Crear el backup
        SET @sql = 'BACKUP DATABASE [' + @name + '] TO DISK = ''' + @fileName + ''' WITH INIT, COMPRESSION, CHECKSUM'
        
        PRINT 'Ejecutando backup: ' + @sql
        EXEC sp_executesql @sql

        -- Verificar el backup
        SET @sql = 'RESTORE VERIFYONLY FROM DISK = ''' + @fileName + ''''
        PRINT 'Verificando backup: ' + @sql
        EXEC sp_executesql @sql

        -- Mostrar información del backup
        SET @sql = 'RESTORE HEADERONLY FROM DISK = ''' + @fileName + ''''
        PRINT 'Información del backup:'
        EXEC sp_executesql @sql

        PRINT 'Backup creado exitosamente: ' + @fileName
    END TRY
    BEGIN CATCH
        SET @errorMessage = ERROR_MESSAGE()
        PRINT 'Error durante el backup: ' + @errorMessage
    END CATCH
END
GO
/****** Object:  StoredProcedure [dbo].[cat_DeleteCategoria]    Script Date: 10/11/2024 19:52:19 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[cat_DeleteCategoria]
	@id uniqueidentifier
AS
BEGIN
	update categorias
	set deleted = 1
	where id_categoria = @id;

	update opciones
	set deleted = 1
	where id_categoria = @id;

END
GO
/****** Object:  StoredProcedure [dbo].[cat_GetAllCategorias]    Script Date: 10/11/2024 19:52:19 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[cat_GetAllCategorias]
	@nombre nvarchar(max)
AS
BEGIN

	select 
		c.id_categoria as categoria_id,
		c.nombre as categoria_nombre,
		o.id_opcion as opcion_id,
		o.nombre as opcion_nombre
	from categorias c 
	left join opciones o on o.id_categoria = c.id_categoria
	where c.deleted = 0
	and (@nombre is null or c.nombre like '%'+ @nombre +'%')

END
GO
/****** Object:  StoredProcedure [dbo].[cat_SaveCategoria]    Script Date: 10/11/2024 19:52:19 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[cat_SaveCategoria]
	@id uniqueidentifier,
	@nombre nvarchar(max)
AS
BEGIN
	
	if not exists (select 1 from categorias where id_categoria = @id)
	begin
		insert into categorias(id_categoria,nombre,deleted)
		values (@id,@nombre,0)
	end
	else
	begin
		update categorias
		set nombre = @nombre
		where id_categoria = @id
	end

END
GO
/****** Object:  StoredProcedure [dbo].[cat_SaveCategoriaOpcion]    Script Date: 10/11/2024 19:52:19 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[cat_SaveCategoriaOpcion]
	@id uniqueidentifier,
	@nombre nvarchar(max),
	@idCategoria uniqueidentifier
AS
BEGIN
	
	if not exists (select 1 from opciones where id_opcion = @id)
	begin
		insert into opciones(id_opcion,id_categoria,nombre,deleted)
		values (@id,@idCategoria,@nombre,0)
	end
	else
	begin
		update opciones
		set nombre = @nombre
		where id_opcion = @id
	end

END
GO
/****** Object:  StoredProcedure [dbo].[dvf_GetDVbyName]    Script Date: 10/11/2024 19:52:19 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[dvf_GetDVbyName]
	@tNombre nvarchar(50)

AS
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

    SELECT DV FROM tablas_dv WHERE nombre_tabla = @tNombre
END
GO
/****** Object:  StoredProcedure [dbo].[dvf_UpdateTableDV]    Script Date: 10/11/2024 19:52:19 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[dvf_UpdateTableDV]
	@tNombre nvarchar(50),
	@DV nvarchar(max)

AS
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

    IF NOT EXISTS (SELECT * FROM tablas_dv WHERE nombre_tabla = @tNombre)
	BEGIN 
		INSERT INTO tablas_dv(nombre_tabla,DV)
		VALUES (@tNombre,@DV);
	END
	ELSE
	BEGIN
		UPDATE tablas_dv
		SET DV = @DV
		WHERE nombre_tabla = @tNombre;
	END
END
GO
/****** Object:  StoredProcedure [dbo].[lng_GetAllIdiomas]    Script Date: 10/11/2024 19:52:19 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[lng_GetAllIdiomas]
AS
BEGIN

	select id_idioma,descripcion from idiomas

END
GO
/****** Object:  StoredProcedure [dbo].[lng_GetAllTerminos]    Script Date: 10/11/2024 19:52:19 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[lng_GetAllTerminos]
AS
BEGIN

	select id_termino,descripcion 
	from terminos

END
GO
/****** Object:  StoredProcedure [dbo].[lng_GetAllTraducciones]    Script Date: 10/11/2024 19:52:19 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE PROCEDURE [dbo].[lng_GetAllTraducciones]
	@idIdioma uniqueidentifier
AS
BEGIN
	select tt.traduccion,t.id_termino, t.descripcion
	from traduccion tt
	join terminos t on t.id_termino = tt.id_termino
	where tt.id_idioma = @idIdioma
END
GO
/****** Object:  StoredProcedure [dbo].[lng_SaveIdioma]    Script Date: 10/11/2024 19:52:19 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/*
Idioma ObtenerIdiomaDefault();
List<Idioma> ObtenerIdiomas();
IDictionary<string, Traduccion> ObtenerTraducciones(Guid idioma);
List<Traduccion> GetAllTerminos(Idioma idioma = null);
bool InsertIdioma(Idioma idioma);
bool SaveTraduccion(List<Traduccion> traduc, Idioma idioma);


*/

CREATE PROCEDURE [dbo].[lng_SaveIdioma]

	@id uniqueidentifier,
	@descripcion nvarchar(max)
AS
BEGIN

if not exists (select 1 from idiomas where id_idioma = @id)
	begin
		insert into idiomas(id_idioma,descripcion)
		values (@id,@descripcion)
	end 
else
	begin
		update idiomas
		set descripcion = @descripcion
		where id_idioma = @id
	end

END
GO
/****** Object:  StoredProcedure [dbo].[lng_SaveTraduccion]    Script Date: 10/11/2024 19:52:19 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[lng_SaveTraduccion]

	@idIdioma uniqueidentifier,
	@idTermino uniqueidentifier,
	@traduccion nvarchar(max)
AS
BEGIN

if not exists (select 1 from traduccion where id_idioma = @idIdioma and id_termino = @idTermino)
	begin
		insert into traduccion(id_idioma,id_termino,traduccion)
		values (@idIdioma,@idTermino,@traduccion)
	end 
else
	begin
		update traduccion
		set traduccion = @traduccion
		where id_idioma = @idIdioma and id_termino = @idTermino
	end

END
GO
/****** Object:  StoredProcedure [dbo].[log_GetUserFiltered]    Script Date: 10/11/2024 19:52:19 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE PROCEDURE [dbo].[log_GetUserFiltered]
	@from datetime,
	@to datetime,
	@action nvarchar(50),
	@page int
as
	--DECLARE @PageNumber AS INT
    DECLARE @RowsOfPage AS INT
    DECLARE @MaxTablePage  AS FLOAT 

	--SET @PageNumber=1
    SET @RowsOfPage=20
	SELECT @MaxTablePage = COUNT(*) FROM log_usuario
    SET @MaxTablePage = CEILING(@MaxTablePage/@RowsOfPage)
    WHILE @MaxTablePage >= @Page
begin

	select	
		lu.id_log,
		u.id_usuario,
		u.nombres,
		u.apellidos,
		u.email,
		dbo.DesencriptarDato(lu.accion) as 'accion',
		dbo.DesencriptarDato(lu.fecha) as 'fecha'
	from log_usuario lu
	inner join usuario u on u.id_usuario = dbo.DesencriptarDato(lu.id_usuario)
	WHERE (@action IS NULL OR dbo.DesencriptarDato(lu.accion) LIKE '%' + @action + '%')
    AND (CONVERT(datetime,dbo.DesencriptarDato(lu.fecha)) >= @from AND CONVERT(datetime,dbo.DesencriptarDato(lu.fecha)) < DATEADD(day, 1, @to) OR @from IS NULL OR @to IS NULL)
	order by lu.fecha desc
	OFFSET (@Page-1)*@RowsOfPage ROWS
    FETCH NEXT @RowsOfPage ROWS ONLY
    SET @Page = @Page + 1

END
GO
/****** Object:  StoredProcedure [dbo].[mrr_delete]    Script Date: 10/11/2024 19:52:19 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE PROCEDURE [dbo].[mrr_delete]
AS
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

    DELETE FROM mirror_usuario
END
GO
/****** Object:  StoredProcedure [dbo].[mrr_GetIntegrityAnomalies]    Script Date: 10/11/2024 19:52:19 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[mrr_GetIntegrityAnomalies]
AS
BEGIN

    SELECT
        'usuario' AS tabla,
        /*CASE 
            WHEN um.action_type = 'Modified' THEN
                (SELECT ROW_NUMBER() OVER (ORDER BY u.id_usuario) FROM usuario uu WHERE uu.id_usuario = um.id_usuario OR u.dv = um.dv) -- Encontrar la fila en usuario si es modificado
            ELSE NULL
        END AS fila_registro,*/
        u.id_usuario AS usuario_actual,
        um.id_usuario AS usuario_mrr,
        um.action_type,
        CASE 
            WHEN um.action_type = 'Modified' THEN
                STUFF(
                    CONCAT(
                        CASE WHEN u.nombres <> um.nombres THEN ', nombres' ELSE '' END,
                        CASE WHEN u.apellidos <> um.apellidos THEN ', apellidos' ELSE '' END,
                        CASE WHEN u.dni <> um.dni THEN ', dni' ELSE '' END,
                        CASE WHEN u.email <> um.email THEN ', email' ELSE '' END,
                        CASE WHEN u.telefono <> um.telefono THEN ', telefono' ELSE '' END,
                        CASE WHEN u.clave <> um.clave THEN ', clave' ELSE '' END,
                        CASE WHEN u.fecha_nacimiento <> um.fecha_nacimiento THEN ', fecha_nacimiento' ELSE '' END,
                        CASE WHEN u.direccion <> um.direccion THEN ', direccion' ELSE '' END,
                        CASE WHEN u.codigo_postal <> um.codigo_postal THEN ', codigo_postal' ELSE '' END,
                        CASE WHEN u.dv <> um.dv THEN ', dv' ELSE '' END,
                        CASE WHEN u.fecha_creacion <> um.fecha_creacion THEN ', fecha_creacion' ELSE '' END,
                        CASE WHEN u.salt <> um.salt THEN ', salt' ELSE '' END,
                        CASE WHEN u.deleted <> um.deleted THEN ', deleted' ELSE '' END
                    ),
                    1, 2, ''
                )
            WHEN um.action_type = 'Deleted' THEN NULL
            ELSE NULL
        END AS campo_modificado
    FROM mirror_usuario um
    LEFT JOIN usuario u ON u.id_usuario = um.id_usuario OR u.dv = um.dv;

END
GO
/****** Object:  StoredProcedure [dbo].[org_Add_organizacion_user]    Script Date: 10/11/2024 19:52:19 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[org_Add_organizacion_user]
	@idUser uniqueidentifier,
	@idOrg uniqueidentifier
AS
BEGIN
	if not exists (select 1 from organizacion_usuario where id_organizacion = @idOrg and id_usuario = @idUser)
	begin
		insert into organizacion_usuario(id_organizacion,id_usuario)
		values(@idOrg,@idUser)
	end 
END
GO
/****** Object:  StoredProcedure [dbo].[org_Delete_organizacion_user]    Script Date: 10/11/2024 19:52:19 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[org_Delete_organizacion_user]
	@idUser uniqueidentifier,
	@idOrg uniqueidentifier
AS
BEGIN
	if exists (select 1 from organizacion_usuario where id_organizacion = @idOrg and id_usuario = @idUser)
	begin
		delete from organizacion_usuario
		where id_organizacion = @idOrg and id_usuario = @idUser
	end 
END
GO
/****** Object:  StoredProcedure [dbo].[org_DeleteOrganizacion]    Script Date: 10/11/2024 19:52:19 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[org_DeleteOrganizacion]
	@id uniqueidentifier
AS
BEGIN
	update organizacion
	set deleted = 1
	where id_organizacion = @id
END
GO
/****** Object:  StoredProcedure [dbo].[org_GetAllOrganizaciones]    Script Date: 10/11/2024 19:52:19 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[org_GetAllOrganizaciones]
	@idUser uniqueidentifier,
	@idOrg uniqueidentifier
AS
BEGIN
	select 
		o.id_organizacion,
		o.nombre,
		o.razon_social,
		o.direccion,
		o.codigo_postal,
		o.digito_verificador,
		o.fecha_creacion
	from organizacion o
	left join organizacion_usuario ou on ou.id_organizacion = o.id_organizacion
	where deleted = 0 
	and (@idUser is null or ou.id_usuario = @idUser)
	and (@idOrg is null or o.id_organizacion = @idOrg)
END
GO
/****** Object:  StoredProcedure [dbo].[org_SaveOrganizacion]    Script Date: 10/11/2024 19:52:19 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[org_SaveOrganizacion]
	@id uniqueidentifier,
	@nombre nvarchar(max),
	@razon nvarchar(max),
	@direccion nvarchar(max),
	@codPostal int,
	@dv nvarchar(max)
AS
BEGIN
	SET NOCOUNT ON;

	if not exists (select 1 from organizacion where id_organizacion = @id)
		begin
			insert into organizacion(id_organizacion,nombre,razon_social,direccion,codigo_postal,digito_verificador,fecha_creacion,deleted)
			values(@id,@nombre,@razon,@direccion,@codPostal,@dv,GETDATE(),0)
		end
	else
		begin
			update organizacion
			set nombre = @nombre,
				direccion = @direccion,
				codigo_postal = @codPostal,
				digito_verificador = @dv
			where id_organizacion = @id
		end
END
GO
/****** Object:  StoredProcedure [dbo].[pub_GetAllPublicacionByUser]    Script Date: 10/11/2024 19:52:19 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[pub_GetAllPublicacionByUser]
	@idUser uniqueidentifier

AS
BEGIN
	
	select 
		p.id_publicacion,
		p.id_tipo as tipo_id,
		pt.descripcion as tipo_descripcion,
		p.titulo,
		p.descripcion,
		p.historia,
		p.ubicacion,
		p.fecha_creacion,
		o.id_opcion as opcion_id,
		o.nombre as opcion_nombre
	from publicacion p
	join publicacion_tipos pt on pt.id_tipo = p.id_tipo
	left join publicacion_opciones po on po.id_publicacion = p.id_publicacion
	left join opciones o on o.id_opcion = po.id_opcion
	where p.deleted = 0

END
GO
/****** Object:  StoredProcedure [dbo].[pub_GetAllTipos]    Script Date: 10/11/2024 19:52:19 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[pub_GetAllTipos]
AS
BEGIN
	select * 
	from publicacion_tipos
END
GO
/****** Object:  StoredProcedure [dbo].[pub_SavePublicacion]    Script Date: 10/11/2024 19:52:19 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[pub_SavePublicacion]
	@id uniqueidentifier,
	@idUser uniqueidentifier,
	@idTipo uniqueidentifier,
	@titulo nvarchar(max),
	@descripcion nvarchar(max),
	@historia nvarchar(max),
	@ubicacion nvarchar(max)

AS
BEGIN
	if not exists (select 1 from publicacion where id_publicacion = @id)
	begin
		insert into publicacion (id_publicacion,id_usuario,id_tipo,titulo,descripcion,historia,ubicacion,fecha_creacion,deleted)
		values(@id,@idUser,@idTipo,@titulo,@descripcion,@historia,@ubicacion,GETDATE(),0)
	end
	else
	begin
		update publicacion
		set titulo = @titulo,
			descripcion = @descripcion,
			historia = @historia,
			ubicacion = @ubicacion
		where id_publicacion = @id
	end
END
GO
/****** Object:  StoredProcedure [dbo].[pub_SavePublicacionOpcion]    Script Date: 10/11/2024 19:52:19 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[pub_SavePublicacionOpcion]
	@idPublicacion uniqueidentifier,
	@idOpcion uniqueidentifier

AS
BEGIN
	if not exists (select 1 from publicacion_opciones where id_publicacion = @idPublicacion and id_opcion = @idOpcion)
	begin
		insert into publicacion_opciones(id_publicacion,id_opcion)
		values (@idPublicacion,@idOpcion)
	end
END
GO
/****** Object:  StoredProcedure [dbo].[usr_DeleteUser]    Script Date: 10/11/2024 19:52:19 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE PROCEDURE [dbo].[usr_DeleteUser]
	
	@idUser uniqueidentifier
AS
BEGIN
	SET NOCOUNT ON;

	UPDATE usuario
	SET deleted = 1
	WHERE id_usuario = @idUser

END
GO
/****** Object:  StoredProcedure [dbo].[usr_GetAllUsers]    Script Date: 10/11/2024 19:52:19 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE PROCEDURE [dbo].[usr_GetAllUsers]
	
AS
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

    SELECT * FROM usuario
	WHERE deleted = 0
END
GO
/****** Object:  StoredProcedure [dbo].[usr_GetById]    Script Date: 10/11/2024 19:52:19 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE PROCEDURE [dbo].[usr_GetById]
	
	@id uniqueidentifier
AS
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

    SELECT * FROM usuario
	WHERE id_usuario = @id

END
GO
/****** Object:  StoredProcedure [dbo].[usr_GetUserByEmail]    Script Date: 10/11/2024 19:52:19 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Author,,Name>
-- Create date: <Create Date,,>
-- Description:	<Description,,>
-- =============================================
CREATE PROCEDURE [dbo].[usr_GetUserByEmail]
	@email nvarchar(50)
AS
BEGIN
	SET NOCOUNT ON;

    SELECT  
	id_usuario,
	nombres,
	apellidos,
	clave,
	dni,
	email,
	telefono,
	fecha_nacimiento,
	direccion,
	codigo_postal,
	fecha_creacion,
	dv,
	salt
	FROM usuario u
	WHERE email = @email

END
GO
/****** Object:  StoredProcedure [dbo].[usr_GetUserRoles]    Script Date: 10/11/2024 19:52:19 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE PROCEDURE [dbo].[usr_GetUserRoles]
	@idUsuario uniqueidentifier
AS
BEGIN

	SET NOCOUNT ON;

    SELECT 
		r.id_rol,
		r.nombre_rol
	FROM rol r
	JOIN usuario_rol ur on ur.id_rol = r.id_rol
	WHERE ur.id_usuario = @idUsuario;

END
GO
/****** Object:  StoredProcedure [dbo].[usr_InsertUser]    Script Date: 10/11/2024 19:52:19 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE PROCEDURE [dbo].[usr_InsertUser]
  @nombres nvarchar(MAX),
  @apellidos nvarchar(MAX),
  @dni nvarchar(MAX),
  @email nvarchar(MAX),
  @telefono nvarchar(MAX),
  @clave nvarchar(MAX),
  @fecha_nacimiento datetime,
  @direccion nvarchar(MAX),
  @codigo_postal int,
  @dv nvarchar(MAX),
  @fecha_creacion datetime,
  @salt varbinary(MAX),
  @idIdioma uniqueidentifier
AS
BEGIN

	IF NOT EXISTS (SELECT 1 FROM usuario where email = @email)
	BEGIN
		declare @id uniqueidentifier = newid()

		INSERT INTO usuario(
			id_usuario,
			nombres,
			apellidos,
			dni,
			email,
			telefono,
			clave,
			fecha_nacimiento,
			direccion,
			codigo_postal,
			dv,
			fecha_creacion,
			salt,
			deleted,
			id_idioma
		  )
		  VALUES (
			@id,
			@nombres,
			@apellidos,
			@dni,
			@email,
			@telefono,
			@clave,
			@fecha_nacimiento,
			@direccion,
			@codigo_postal,
			@dv,
			@fecha_creacion,
			@salt,
			0,
			@idIdioma
		  );

		  select @id as 'id_usuario'
	END
	ELSE
	BEGIN 
		RAISERROR('Ya se encuentra un usuario registrado con el email', 16, 1);
	END

END
GO
/****** Object:  StoredProcedure [dbo].[usr_InsertUserLog]    Script Date: 10/11/2024 19:52:19 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[usr_InsertUserLog]
    @idUsuario uniqueidentifier,
    @accion nvarchar(50)
AS
BEGIN
    SET NOCOUNT ON;
    INSERT INTO log_usuario(id_log, id_usuario, accion, fecha) 
    VALUES (
        dbo.EncriptarDato(CONVERT(nvarchar(36), NEWID())),
        dbo.EncriptarDato(CONVERT(nvarchar(36), @idUsuario)),
        dbo.EncriptarDato(@accion),
        dbo.EncriptarDato(CONVERT(NVARCHAR(23), GETDATE()))
    );
END
GO
/****** Object:  StoredProcedure [dbo].[usr_SetUsuarioRol]    Script Date: 10/11/2024 19:52:19 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE PROCEDURE [dbo].[usr_SetUsuarioRol]
	
	@idRol uniqueidentifier,
	@idUsuario uniqueidentifier

AS
BEGIN
	SET NOCOUNT ON;

    IF NOT EXISTS (SELECT 1 FROM usuario_rol WHERE id_usuario = @idUsuario AND id_rol = @idRol )
	BEGIN
		INSERT INTO usuario_rol (id_rol,id_usuario) VALUES (@idRol,@idUsuario)
	END
END
GO
/****** Object:  StoredProcedure [dbo].[usr_UpdateUser]    Script Date: 10/11/2024 19:52:19 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[usr_UpdateUser]
  @id uniqueidentifier,
  @email nvarchar(MAX),
  @telefono nvarchar(MAX),
  @clave nvarchar(MAX),
  @direccion nvarchar(MAX),
  @codigo_postal int
AS
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

    UPDATE usuario 
	SET email = @email,
	telefono = @telefono,
	clave = @clave,
	direccion = @direccion,
	codigo_postal = @codigo_postal
	WHERE id_usuario = @id
END
GO
/****** Object:  StoredProcedure [dbo].[usr_UpdateUserDV]    Script Date: 10/11/2024 19:52:19 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[usr_UpdateUserDV]
  @id uniqueidentifier,
  @dv nvarchar(MAX)
AS
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

    UPDATE usuario 
	SET dv = @dv
	WHERE id_usuario = @id
END
GO
USE [master]
GO
ALTER DATABASE [FindFiddo_App] SET  READ_WRITE 
GO
